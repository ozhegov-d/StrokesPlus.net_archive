function sendText() {
    var inputFile = `
[Roman Numerals]
1                        | roman1                       | â…   
2                        | roman2                       | â…¡
3                        | roman3                       | â…¢
4                        | roman4                       | â…£
5                        | roman5                       | â…¤
6                        | roman6                       | â…¥
7                        | roman7                       | â…¦  
8                        | roman8                       | â…§
9                        | roman9                       | â…¨
10                       | roman10                      | â…©
11                       | roman11                      | â…ª
12                       | roman12                      | â…«
50                       | roman50                      | â…¬  
100                      | roman100                     | â…­
500                      | roman500                     | â…®
1000                     | roman1000                    | â…¯

[Brackets]
parentheses              | parent                       | ( )  
brackets square          | squarebracket                | [ ]
bracket curly            | curlybracket                 | { }
super script parentheses | ^, superscr                  | Xâ½Â²â¾
sub script parentheses   | !^, subscr                   | Xâ‚â‚‚â‚
tortoise shell bracket   | tortoise, shell              | ã€”...ã€•
boxed text               | boxed                        | â¸...â¹
bracket angle            | anglebracket                 | âŸ¨ âŸ©  
bracket ceiling          | ceilingbracket               | âŒˆ âŒ‰
bracket floor            | floorbracket                 | âŒŠ âŒ‹
quasi-quotation          | quine, topbracket, quasi     | âŒœâŒ
editorial notation       | botbracket, editorial        | âŒâŒŸ
curly bracket extension  | curlyextension, extension    | âª  

[ASCII texts]
coffee                   | coffee                       | c[_]
bored                    | bored                        | (-_-)
bearhug                  | bearhug                      | Ê•ã£â€¢á´¥â€¢Ê”ã£
creep                    | creep                        | Æª(Ú“×²)Æª  
endure                   | endure                       | (Ò‚^.^)á•¤
fancyme                  | fancyme                      | Ğ²Ñ”Ï‰Î±ÑÑ”, Î¹ Î±Ğ¼ Æ’Î±Î·Â¢Ñƒ!  
fancyyou                 | fancyyou                     | Ğ²Ñ”Ï‰Î±ÑÑ”, you Î±ÑÑ” Æ’Î±Î·Â¢Ñƒ! 
flower                   | flower                       | (âœ¿â— â€¿â— )
greetings                | greetings                    | Oâ•¯[Greetings{!}]
internet                 | internet                     | à¬˜(à©­*ËŠáµ•Ë‹)à©­* Ì€Ë‹ ÉªÉ´á´›á´‡Ê€É´á´‡á´›{!}
bearlove                 | bearlove                     | Ê•â™¥á´¥â™¥Ê”
meh                      | meh                          | à² _à²   
look_disapproval_inten   | look_disapproval_inten       | à² __à² 
look_disapproval_asian   | look_disapproval_asian       | à² ç›Šà² 
rolleyes                 | rolleyes                     | _<oO>_
wut                      | wut                          | OÏ‰O
uwu                      | uwu                          | UÏ‰U
hmm                      | hmm                          | Â¯\_(ãƒ„)_/Â¯

dollar1                  | dollar1                      | [Ì²Ì…$Ì²Ì…(Ì²Ì…1Ì²Ì…)Ì²Ì…$Ì²Ì…]
dollar5                  | dollar5                      | [Ì²Ì…$Ì²Ì…(Ì²Ì…5Ì²Ì…)Ì²Ì…$Ì²Ì…]
dollar10                 | dollar10                     | [Ì²Ì…$Ì²Ì…(Ì²Ì…1Ì²Ì…0Ì²Ì…)Ì²Ì…$Ì²Ì…]
dollar100                | dollar100                    | [Ì²Ì…$Ì²Ì…(Ì²Ì…Î¹Î¿Î¿Ì²Ì…)Ì²Ì…$Ì²Ì…]
lennyface                | lennyface                    | ( Í¡Â° ÍœÊ– Í¡Â°)
raiseyourdongers         | raiseyourdongers             | ãƒ½à¼¼àºˆÙ„Íœàºˆà¼½ï¾‰

bat                      | bat                          | â›â(â€¢â±…â€¢)â â
flowergirl               | flowergirl                   | (â—•â€¿â—•âœ¿)
crying                   | crying                       | ( à¼àº¶ Û à¼àº¶ )
cat                      | cat                          | (=Ê˜á†½Ê˜=)âˆ«
catpaws                  | catpaws                      | à¸…(^â€¢ï»Œâ€¢^à¸…)
bear                     | bear                         | Ê• â€¢á´¥â€¢Ê”
bearpaw                  | bearpaw                      | Ê• Â·(ã‚¨)Â· Ê”
bearcute                 | bearcute                     | Ê• â€“ ã‰¨ â€“ Ê”
bearhug                  | bearhug2                     | âŠ‚(ï¿£(ï½´)ï¿£)âŠƒ

[ASCII symbols]  
EUR                      | EUR                          | â‚¬
summa                    | sum, total                   | âˆ‘
delta                    | delta, diff                  | Î”
approximately            | cirka, appr                  | âˆ¼
tiny square              | square, tinysq               | â–ª
normal square            | normalsq, normalsquare       | â–   
big square               | bigsq, fatsq                 | â¹
dotted rectangle         | dottedre, dotrect            | âŠ¡
dotted ring              | dottedri, dotring            | âŠ™
single left arrow        | arrow1L                      | â€¹
single right arrow       | arrow1R                      | â€º
double left arrow        | leftarrow, arrowleft         | â€¹â€¹
double right arrow       | rightarrow, arrowright       | â€ºâ€º
left arrows              | leftarrow, arrowleft         | âŸª
right arrows             | rightarrow, arrowright       | âŸ«
fat arrow left           | fatarrowL                    | â‡  
fat arrow right          | fatarrowT                    | â‡’
fat arrow top            | fatarrowtop, arrowtop        | â‡‘
fat arrow bot            | fatarrowbot, arrowbot        | â‡“
fat arrows horizontal    | arrowH, fatarrowH            | â‡”
fat arrow vertical       | arrowV, fatarrowV            | â‡•
small triangle left      | triangleL                    | â´  
small triangle right     | triangleR                    | âµ
small triangle top       | triangleT                    | â¶
small triangle bot       | triangleB                    | â·
triangle upper left      | triangleUL                   | â—¤
triangle upper right     | triangleUR                   | â—¥
triangle bot left        | triangleBL                   | â—£
triangle bot right       | triangleBR                   | â—¢
triangle top             | triangletop, toptriang       | âˆ† 
triangle bot             | trianglebot, bottriang       | âˆ‡

[Emoji symbols]
checked norm             | checkednorm                  | âœ” 
checked thin             | checkedthin                  | âœ“
crossed 1                | crossed1                     | âŒ
crossed 2                | crossed2                     | â
crossed 3                | crossed3                     | âœ•
crossed 4                | crossed4                     | âœ–  
crossed 5                | crossed5                     | âœ—
crossed 6                | crossed6                     | âœ˜
question red             | questionred                  | â“
question white           | questionwhite                | â”
exclamation white        | exclamationwhite             | â•
exclamation red          | exclamationred               | â—
alarm clock              | alarmclock                   | â°
wall clock               | wallclock                    | âŒš
hourglass full           | hourglassfull                | âŒ›
hourglass half           | hourglasshalf                | â³
small heart              | smallhearth                  | â™¡
electricity              | electricity                  | âš¡
snowman                  | snowman                      | â›„
cloudy day               | cloud                        | â›…
white big ring           | whitebigring                 | âšª
black big ring           | blackbigring                 | âš«  
white ring               | whitering                    | âº 
small ring               | smallring                    | âš¬
stop sign                | stop, dont                   | â›”
pause                    | pause                        | â¸
radioactive              | radioactive                  | â˜¢
biohazard                | biohazard                    | â˜£
peace                    | peace                        | â˜®
yin yang                 | yinyang                      | â˜¯
wheel of dharma          | wheelofdharma                | â˜¸
frowning face            | frowningface                 | â˜¹
black smiling face       | blacksmilingface             | â˜»
white smiling face       | whitesmilingface             | â˜º
black star               | blackstar                    | â˜…
white star               | whitestar                    | â˜†

[Emoji faces]
angry                    |                              | ğŸ˜ 
angry red                |                              | ğŸ˜¡
evil                     |                              | ğŸ˜ˆ
eyes                     | eyes, rolleyes, check        | ğŸ‘€
smile                    | smile, grin                  | ğŸ˜
crying out loud          | cryingoutloud, col           | ğŸ˜‚  
smiling eyes             | smilingeyes                  | ğŸ˜„
open mouth               | openmouth                    | ğŸ˜ƒ
joy                      | joy, tears                   | ğŸ˜‚
rolling on the floor     | rofl                         | ğŸ¤£
laughing hand            | laughing                     | ğŸ¤­
embarassed               | embarassed                   | ğŸ˜Š
halo                     | halo, saint                  | ğŸ˜‡
upside down              | upsidedown                   | ğŸ™ƒ
winking                  | wink                         | ğŸ˜‰
relived                  | relived                      | ğŸ˜Œ
love eyes                | love                         | ğŸ˜
delicous                 | delicious, toungue, yummi    | ğŸ˜‹  
sunglasses               | sunglass, cool               | ğŸ˜
hearths                  | hearth                       | ğŸ¥°
thinking                 | think                        | ğŸ¤”

[Emoji hands]  
perfect                  | ok, perfect                  | ğŸ‘Œ
victory                  | victory, win                 | âœŒ
fingers crossed          | fingerscrossed               | ğŸ¤
love you                 | lovey, rockit                | ğŸ¤Ÿ
call me                  | callme                       | ğŸ¤™  
thumbs up                | thumbsup                     | ğŸ‘
thumbs down              | thumbsdown                   | ğŸ‘
fist                     | fist                         | ğŸ‘Š 
left fist                | leftfist                     | ğŸ¤›
right fist               | rightfist                    | ğŸ¤œ
handshake                | handshake                    | ğŸ¤
praying                  | pray                         | ğŸ™
clapping                 | clap                         | ğŸ‘  
raising hand             | raisin                       | ğŸ™Œ
palm up together         | handspalms                   | ğŸ¤²
hand                     | hand                         | âœ‹
listen                   | listen, important            | â˜

[Emoji transport]
automobile               | automobile                   | ğŸš—
delivery truck           | deliverytruck                | ğŸšš
bus                      | bus                          | ğŸšŒ
trolleybus               | trolleybus                   | ğŸš
racing car               | racingcar                    | ğŸ
police car               | policecar                    | ğŸš“
ambulance                | ambulance                    | ğŸš‘
fire engine              | fireengine                   | ğŸš’
helicopter               | helicopter                   | ğŸš
steam locomotive         | steamlocomotive              | ğŸš‚
train                    | train                        | ğŸš‹
light rail               | lightrail                    | ğŸšˆ
tram                     | tram                         | ğŸšŠ
monorail                 | monorail                     | ğŸš
mountain railway         | mountainrailway              | ğŸš
tram car                 | tramcar                      | ğŸš‹
bus stop                 | busstop                      | ğŸš
fuel pump                | fuelpump                     | â›½
construction             | construction                 | ğŸš§

[Emoji nature]
globe showing europe-africa | globeeurope              | ğŸŒ 
globe showing americas   | globeamericas                | ğŸŒ
globe showing asia-australia | globeaustral           | ğŸŒ
new moon                 | newmoon                      | ğŸŒ‘
waxing crescent moon     | waxingcrescent               | ğŸŒ’
first quarter moon       | firstquarter                 | ğŸŒ“
waxing gibbous moon      | waxinggibbous                | ğŸŒ”
full moon                | fullmoon                     | ğŸŒ•  
waning gibbous moon      | waninggibbous                | ğŸŒ–
last quarter moon        | lastquarter                  | ğŸŒ—
waning crescent moon     | waningcrescent               | ğŸŒ˜
crescent moon            | crescentmoon                 | ğŸŒ™
new moon face            | newmoonface                  | ğŸŒš
full moon face           | fullmoonface                 | ğŸŒ
sun                      | sun                          | â˜€
sun 1                    | sun 1                        | â˜¼
sun with face            | sunface                      | ğŸŒ
ringed planet            | ringedplanet                 | ğŸª
star                     | star                         | â­
glowing star             | glowingstar                  | ğŸŒŸ
shooting star            | shootingstar                 | ğŸŒ 
comet                    | comet                        | â˜„
milky way                | milkyway                     | ğŸŒŒ
cloud                    | cloud                        | â˜
sun behind cloud         | suncloud                     | â›…
cloud with lightning and rain | cloudlightningrain    | â›ˆ
rainbow                  | rainbow                      | ğŸŒˆ
umbrella                 | umbrella                     | â˜‚
sun behind cloud         | sunbehindcloud               | â›…
thunder cloud and rain   | thundercloudrain             | â›ˆ
lightning                | lightning                    | â˜‡
thunderstorm             | thunderstorm                 | â˜ˆ

[Emoji food]
green apple              | greenapple                   | ğŸ
red apple                | redapple                     | ğŸ
pear                     | pear                         | ğŸ
tangerine                | tangerine                    | ğŸŠ
lemon                    | lemon                        | ğŸ‹
banana                   | banana                       | ğŸŒ
watermelon               | watermelon                   | ğŸ‰
grapes                   | grapes                       | ğŸ‡
strawberry               | strawberry                   | ğŸ“
melon                    | melon                        | ğŸˆ
cherries                 | cherries                     | ğŸ’ 
peach                    | peach                        | ğŸ‘
pineapple                | pineapple                    | ğŸ
coconut                  | coconut                      | ğŸ¥¥
kiwi fruit               | kiwi                         | ğŸ¥
tomato                   | tomato                       | ğŸ…
avocado                  | avocado                      | ğŸ¥‘
eggplant                 | eggplant                     | ğŸ†
potato                   | potato                       | ğŸ¥”
carrot                   | carrot                       | ğŸ¥•
ear of corn              | corn                         | ğŸŒ½
hot pepper               | hotpepper                    | ğŸŒ¶
cucumber                 | cucumber                     | ğŸ¥’
broccoli                 | broccoli                     | ğŸ¥¦
mushroom                 | mushroom                     | ğŸ„
peanuts                  | peanuts                      | ğŸ¥œ

    `;
    var sect = [];

    inputFile.split("\n").forEach(function(line) {
        if (line.startsWith(";") || line.trim().length < 3) {
            return;
        }
        var cleanLine = line.replace(/\r/g, "");
        if (/^\[.*\]/.test(cleanLine)) {
    var name = cleanLine.slice(1, -1).trim();
    name = name.replace(/[\[\]]/g, '');  
    sect.push({ Name: name, Hotkeys: [] });

        } else {
            var col = cleanLine.split("|").map(function(v, i) {
                v = v.trim();  
                return v;
            });

            var obj = {
                Preview: col[0],  
                Hotstrg: col[1],
                Text: col[2]
            };

            sect[sect.length - 1].Hotkeys.push(obj);  
        }
    });

    var texts = [];
     sect.forEach(function(v) {  
        var sectMenu = [];
        v.Hotkeys.forEach(function(hk) {
            var strg = hk.Text;  
            sectMenu.push({ 
                Name: hk.Preview + "\t" + strg, 
                Callback: `sp.SendString("${strg}");`
            });
        });
        texts.push({ Name: v.Name, Items: sectMenu });
    });  
    return texts;
}

function sendStr(strg) {
    var clipSaved = sp.GetStoredString('EmojiMenuClip');
    sp.StoreString('EmojiMenuClip', strg);   
    sp.SendModifiedVKeys([vk.LCONTROL], [vk.VK_V]);
    sp.Sleep(100);
    sp.StoreString('EmojiMenuClip', clipSaved);  
}

function showMain() {
    var menuItems = sendText();
    
    var popupMenuInfo = new PopupMenuInfoEx(sp.GetCurrentMousePoint());
    
    menuItems.forEach(function(mainItem) {
        var menuItem = new PopupMenuItem(mainItem.Name);  
        mainItem.Items.forEach(function(subItem) {
            menuItem.SubMenuItems.Add(new PopupMenuItem(subItem.Name, subItem.Callback));  
        });
        popupMenuInfo.MenuItems.Add(menuItem);
    });
    
    popupMenuInfo.MenuItems.Add(new PopupMenuItem("-")); 
    popupMenuInfo.MenuItems.Add(new PopupMenuItem("Exit", ""));
    
    sp.ShowPopupMenuEx(popupMenuInfo);  
}

showMain();
